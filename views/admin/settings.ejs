<%- include('partials/header') %>

<% if (message === 'saved') { %>
    <div class="bg-green-900/50 border border-green-500 rounded-lg p-4 mb-6 text-green-300">
        Settings saved successfully!
    </div>
<% } %>
<% if (typeof error !== 'undefined' && error) { %>
    <div class="bg-red-900/50 border border-red-500 rounded-lg p-4 mb-6 text-red-300">
        <%= error %>
    </div>
<% } %>

<div class="flex gap-4 mb-6 border-b border-slate-700">
    <a href="?section=server" class="px-4 py-2 <%= activeSection === 'server' ? 'border-b-2 border-purple-500 text-purple-400' : 'text-slate-400' %>">Server Settings</a>
    <a href="?section=colors" class="px-4 py-2 <%= activeSection === 'colors' ? 'border-b-2 border-purple-500 text-purple-400' : 'text-slate-400' %>">Color Theme</a>
    <a href="?section=mailjet" class="px-4 py-2 <%= activeSection === 'mailjet' ? 'border-b-2 border-purple-500 text-purple-400' : 'text-slate-400' %>">Mailjet</a>
</div>

<% if (activeSection === 'server') { %>
    <form method="POST" class="card p-6 space-y-4">
        <input type="hidden" name="section" value="server">
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="block text-slate-300 mb-2">Server Name</label>
                <input type="text" name="server_name" required value="<%= settings.server_name %>" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white">
            </div>
            <div>
                <label class="block text-slate-300 mb-2">Server IP</label>
                <input type="text" name="server_ip" required value="<%= settings.server_ip %>" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white">
            </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="block text-slate-300 mb-2">Server Port</label>
                <input type="number" name="server_port" required value="<%= settings.server_port %>" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white">
            </div>
            <div>
                <label class="block text-slate-300 mb-2">Max Players</label>
                <input type="number" name="max_players" required value="<%= settings.max_players %>" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white">
            </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="block text-slate-300 mb-2">Server Version</label>
                <input type="text" name="server_version" value="<%= settings.server_version || '' %>" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white">
            </div>
            <div>
                <label class="block text-slate-300 mb-2">Server Type</label>
                <select name="server_type" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white">
                    <option value="survival" <%= settings.server_type === 'survival' ? 'selected' : '' %>>Survival</option>
                    <option value="creative" <%= settings.server_type === 'creative' ? 'selected' : '' %>>Creative</option>
                    <option value="pvp" <%= settings.server_type === 'pvp' ? 'selected' : '' %>>PvP</option>
                    <option value="minigames" <%= settings.server_type === 'minigames' ? 'selected' : '' %>>Minigames</option>
                </select>
            </div>
        </div>
        <div>
            <label class="block text-slate-300 mb-2">MOTD</label>
            <input type="text" name="motd" value="<%= settings.motd || '' %>" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white">
        </div>
        <div>
            <label class="block text-slate-300 mb-2">Status Message</label>
            <input type="text" name="status_message" required value="<%= settings.status_message %>" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white">
        </div>
        <div>
            <label class="flex items-center space-x-2">
                <input type="checkbox" name="maintenance_mode" <%= settings.maintenance_mode ? 'checked' : '' %> class="w-4 h-4">
                <span class="text-slate-300">Maintenance Mode</span>
            </label>
        </div>
        <button type="submit" class="btn-primary w-full px-4 py-2 rounded text-white">Save Server Settings</button>
    </form>
<% } else if (activeSection === 'colors') { %>
    <form method="POST" class="card p-6 space-y-4">
        <input type="hidden" name="section" value="colors">
        <p class="text-slate-400 mb-6">Customize the color scheme for the admin panel and public website.</p>
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="block text-slate-300 mb-2">Primary Color</label>
                <input type="color" name="primary_color" id="primary_color" value="<%= colorConfig.admin_primary_color || '#667eea' %>" class="w-full h-10 rounded cursor-pointer" onchange="updateColorText('primary_color', 'primary_text')">
                <input type="text" id="primary_text" value="<%= colorConfig.admin_primary_color || '#667eea' %>" readonly class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 mt-2 text-xs font-mono text-white">
            </div>
            <div>
                <label class="block text-slate-300 mb-2">Secondary Color</label>
                <input type="color" name="secondary_color" id="secondary_color" value="<%= colorConfig.admin_secondary_color || '#764ba2' %>" class="w-full h-10 rounded cursor-pointer" onchange="updateColorText('secondary_color', 'secondary_text')">
                <input type="text" id="secondary_text" value="<%= colorConfig.admin_secondary_color || '#764ba2' %>" readonly class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 mt-2 text-xs font-mono text-white">
            </div>
            <div>
                <label class="block text-slate-300 mb-2">Accent Color</label>
                <input type="color" name="accent_color" id="accent_color" value="<%= colorConfig.admin_accent_color || '#f093fb' %>" class="w-full h-10 rounded cursor-pointer" onchange="updateColorText('accent_color', 'accent_text')">
                <input type="text" id="accent_text" value="<%= colorConfig.admin_accent_color || '#f093fb' %>" readonly class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 mt-2 text-xs font-mono text-white">
            </div>
            <div>
                <label class="block text-slate-300 mb-2">Success Color</label>
                <input type="color" name="success_color" id="success_color" value="<%= colorConfig.admin_success_color || '#10b981' %>" class="w-full h-10 rounded cursor-pointer" onchange="updateColorText('success_color', 'success_text')">
                <input type="text" id="success_text" value="<%= colorConfig.admin_success_color || '#10b981' %>" readonly class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 mt-2 text-xs font-mono text-white">
            </div>
            <div>
                <label class="block text-slate-300 mb-2">Warning Color</label>
                <input type="color" name="warning_color" id="warning_color" value="<%= colorConfig.admin_warning_color || '#f59e0b' %>" class="w-full h-10 rounded cursor-pointer" onchange="updateColorText('warning_color', 'warning_text')">
                <input type="text" id="warning_text" value="<%= colorConfig.admin_warning_color || '#f59e0b' %>" readonly class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 mt-2 text-xs font-mono text-white">
            </div>
            <div>
                <label class="block text-slate-300 mb-2">Danger Color</label>
                <input type="color" name="danger_color" id="danger_color" value="<%= colorConfig.admin_danger_color || '#ef4444' %>" class="w-full h-10 rounded cursor-pointer" onchange="updateColorText('danger_color', 'danger_text')">
                <input type="text" id="danger_text" value="<%= colorConfig.admin_danger_color || '#ef4444' %>" readonly class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 mt-2 text-xs font-mono text-white">
            </div>
            <div>
                <label class="block text-slate-300 mb-2">Info Color</label>
                <input type="color" name="info_color" id="info_color" value="<%= colorConfig.admin_info_color || '#3b82f6' %>" class="w-full h-10 rounded cursor-pointer" onchange="updateColorText('info_color', 'info_text')">
                <input type="text" id="info_text" value="<%= colorConfig.admin_info_color || '#3b82f6' %>" readonly class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 mt-2 text-xs font-mono text-white">
            </div>
        </div>
        <script>
            function updateColorText(colorInputId, textInputId) {
                const colorInput = document.getElementById(colorInputId);
                const textInput = document.getElementById(textInputId);
                if (colorInput && textInput) {
                    textInput.value = colorInput.value;
                }
            }
        </script>
        <button type="submit" class="btn-primary w-full px-4 py-2 rounded text-white">Save Color Theme</button>
    </form>
<% } else if (activeSection === 'mailjet') { %>
    <form method="POST" class="card p-6 space-y-4">
        <input type="hidden" name="section" value="mailjet">
        <p class="text-slate-400 mb-6">Configure Mailjet for sending emails (welcome emails, password resets, etc.)</p>
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="block text-slate-300 mb-2">API Key</label>
                <input type="text" name="mailjet_api_key" value="<%= mailjetConfig.mailjet_api_key || '' %>" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white">
            </div>
            <div>
                <label class="block text-slate-300 mb-2">API Secret</label>
                <input type="password" name="mailjet_api_secret" value="<%= mailjetConfig.mailjet_api_secret || '' %>" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white">
            </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="block text-slate-300 mb-2">From Email</label>
                <input type="email" name="mailjet_from_email" value="<%= mailjetConfig.mailjet_from_email || '' %>" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white">
            </div>
            <div>
                <label class="block text-slate-300 mb-2">From Name</label>
                <input type="text" name="mailjet_from_name" value="<%= mailjetConfig.mailjet_from_name || 'Minecraft Server' %>" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white">
            </div>
        </div>
        <div class="bg-blue-900/30 border border-blue-500/50 rounded-lg p-4">
            <h3 class="text-white font-semibold mb-2"><i class="fas fa-info-circle mr-2"></i>How to Get Mailjet Credentials</h3>
            <ol class="text-sm text-slate-300 space-y-1 list-decimal list-inside">
                <li>Sign up at <a href="https://www.mailjet.com" target="_blank" class="text-blue-400 hover:underline">mailjet.com</a></li>
                <li>Go to Account Settings â†’ API Keys</li>
                <li>Copy your API Key and Secret Key</li>
                <li>Paste them above</li>
            </ol>
        </div>
        <button type="submit" class="btn-primary w-full px-4 py-2 rounded text-white">Save Mailjet Settings</button>
    </form>
<% } %>

<%- include('partials/footer') %>

